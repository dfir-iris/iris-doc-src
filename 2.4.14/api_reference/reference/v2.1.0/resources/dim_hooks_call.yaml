parameters: []
post:
  summary: Call a module
  operationId: post-dim-hooks-call
  responses:
    '200':
      description: OK
  description: >-
    Executes a manual trigger on a specified hook. This allows to trigger a hook
    as it would be done on the GUI. This only concerns manual hooks, and each
    call triggers a specific hook of a specific module, as specified in the
    request. 


    To get a list of all available hooks for a case object, use the
    ``/dim/hooks/options/<type>/list`` endpoint. 
  requestBody:
    content:
      application/json:
        schema:
          description: ''
          type: object
          x-examples:
            example-1:
              hook_name: on_manual_trigger_ioc
              module_name: iris_vt_module
              hook_ui_name: Get VT insight
              csrf_token: >-
                ImI2ZTA3MWM2NjJjYTc2NzVhNmFiMDI3Mjg5MDFhMWEyZGQ4OWQyNDci.YiuPoA.aasIQuo6uNR0EgfYsClsEKLyBKo
              type: ioc
              targets:
                - 10
          properties:
            hook_name:
              type: string
              minLength: 1
              description: >-
                Internal name of the hook as specified in the hook
                documentation.
            module_name:
              type: string
              minLength: 1
              description: Name of the module to call
            hook_ui_name:
              type: string
              minLength: 1
              description: >-
                UI name of the hook, either auto generated by IRIS or provided
                by the module itself. 
            type:
              type: string
              minLength: 1
              description: Type of data processed by the hook (ioc, asset, etc)
            targets:
              type: array
              description: List of objects ID of type "type" to process
              items:
                type: object
          required:
            - hook_name
            - module_name
            - hook_ui_name
            - type
            - targets
        examples:
          example-1:
            value:
              hook_name: on_manual_trigger_ioc
              module_name: iris_vt_module
              hook_ui_name: Get VT insight
              type: ioc
              targets:
                - 10
  tags:
    - Modules
  parameters:
    - schema:
        type: integer
      in: query
      name: cid
      description: Case ID
      required: true
